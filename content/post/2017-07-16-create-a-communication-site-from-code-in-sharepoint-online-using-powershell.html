---
author:
  display_name: Are Flyen
  email: aflyen@gmail.com
  first_name: Are
  last_name: Flyen
  login: aflyen
categories:
- Microsoft 365
- SharePoint
date: "2017-07-16T12:25:58Z"
meta:
  _last_editor_used_jetpack: block-editor
  _oembed_449b87440bd6b8cf2c8796cb3f667851: '{{unknown}}'
  _oembed_160272df7fafa60675e5c5eb250ec07b: '{{unknown}}'
  _publicize_job_id: "7148596545"
  _rest_api_client_id: "-1"
  _rest_api_published: "1"
  _thumbnail_id: "456"
parent_id: "0"
password: ""
published: true
status: publish
tags:
- API
- Development
- PowerShell
- Publishing
title: Create a Communication Site from code in SharePoint Online using PowerShell
type: post
url: /2017/07/16/create-a-communication-site-from-code-in-sharepoint-online-using-powershell/
---
<p>Lately Microsoft released the new &nbsp;and long awaited modern site template for publishing sites in SharePoint Online (Office 365). The site templates is named "Communication Site" and is the second template released after the modern "Team Site". This site template can be created if you have permissions from the SharePoint Home page using the "Create a site" form:</p>
{{< figure src="/assets/2017/07/cpcomsite1.png" width="100%" >}}
<p>This approach is fine if you have permissions to create sites and are happy with the default setup. For my case this is almost never the case. Often the tenants I work with have restricted who can create new sites/groups, and also requires additional configuration after it has been created. This can be accomplished for the new "Team site" template, so I was curious how this can be done for the Communication site.</p>
<p><del>At the time of writing Microsoft have not released any documentation on how to do this, so this was done by re-creating the steps of the "Create a site" wizard (found by using Fiddler). I assume and hope that we sooner or later will find official documentation from Microsoft on how to do this. They might provide us with a bit more elegant way to use their API's. But if you are familiar with using general REST API's, this is pretty straight forward as soon you get authenticated with SharePoint.</del></p>
<p><em>UPDATE (30.10.2017): This <a href="https://docs.microsoft.com/en-us/sharepoint/dev/apis/communication-site-creation-rest">documentation</a> have now been released, and this method is now a supported approach to provision new Communication Sites.</em></p>
<h2>PowerShell script for creating a Communication site</h2>
<p>This script requires the "<a href="https://www.microsoft.com/en-us/download/details.aspx?id=42038">SharePoint Online Client Components</a>" to be installed.</p>
{{< gist aflyen 6649e4228939e1e4f145cf3d15626eec >}}
<h2>Summary</h2>
<p>With the modern sites Microsoft has created several new REST based API's used in their own wizards. These API's can be used as long as you have a user authenticated context.</p>
<p>This code demonstrates how you can create the new Communication Site from code. After the site have been created you are free to connect to the site and apply customizations using in example the <a href="https://github.com/SharePoint/PnP-PowerShell">PnP PowerShell framework</a>.</p>
