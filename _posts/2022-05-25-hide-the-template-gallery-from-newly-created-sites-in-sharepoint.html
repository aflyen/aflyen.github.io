---
layout: post
title: Hide the template gallery from newly created sites in SharePoint
date: 2022-05-25 15:36:58.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Microsoft 365
tags:
- C#
- PnP
- PowerShell
- SharePoint Online
meta:
  _last_editor_used_jetpack: block-editor
  timeline_notification: '1653485820'
  _publicize_job_id: '72922969933'
  _oembed_c521485aa4c571f90743425c03f47182: "{{unknown}}"
  _oembed_e7f26302df764b28d2ca8d9713ecfe03: "{{unknown}}"
  _oembed_fb709518a9ec90f5c133bd47fbeb2cb4: "{{unknown}}"
  _oembed_842fe294055a507fa9463b225c7670a6: "{{unknown}}"
author:
  login: aflyen
  email: aflyen@gmail.com
  display_name: Are Flyen
  first_name: Are
  last_name: Flyen
permalink: "/2022/05/25/hide-the-template-gallery-from-newly-created-sites-in-sharepoint/"
---
<p><!-- wp:paragraph --></p>
<p>When you create new team or communication sites in SharePoint, the first user that visits will be presented with a template gallery picker:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":1364,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="https://aflyen.files.wordpress.com/2022/05/spo-template-gallery.png"><img src="{{ site.baseurl }}/assets/2022/05/spo-template-gallery.png?w=1024" alt="" class="wp-image-1364" /></a></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>This is a great feature for simpler solutions or where you utilize the Site Design to apply your solution. For organizations using their own provisioning solution the site might already be ready to use for the end-user and this dialog might cause confusion, and even end up in the user breaking your ready made site with their own template.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2>Disable the template dialog with PowerShell</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Using the PnP.PowerShell module (https://pnp.github.io/powershell/) you could in example run this after applying a provisioning template:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:embed {"url":"https://gist.github.com/aflyen/dd98179de41d503bbabc0d95822bc704","type":"rich","providerNameSlug":"embed-handler"} --></p>
<figure class="wp-block-embed is-type-rich is-provider-embed-handler wp-block-embed-embed-handler">
<div class="wp-block-embed__wrapper">
https://gist.github.com/aflyen/dd98179de41d503bbabc0d95822bc704
</div>
</figure>
<p><!-- /wp:embed --></p>
<p><!-- wp:heading --></p>
<h2>Disable the template dialog with C#</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>If you are using the PnP.Framework for C# (https://github.com/pnp/pnpframework) you could add this code to your solution to disable the dialog:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:embed {"url":"https://gist.github.com/aflyen/afce1fc44f66e4d2c43194bfbf3d3893","type":"rich","providerNameSlug":"embed-handler"} --></p>
<figure class="wp-block-embed is-type-rich is-provider-embed-handler wp-block-embed-embed-handler">
<div class="wp-block-embed__wrapper">
https://gist.github.com/aflyen/afce1fc44f66e4d2c43194bfbf3d3893
</div>
</figure>
<p><!-- /wp:embed --></p>
<p><!-- wp:heading --></p>
<h2>Summary</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>The web template dialog adds a great capability for basic usage, or even when using Site Design, but can cause unnecessary confusion where you have a enterprise grade provisioning solution. In  these cases it can make sense to disable the dialog.</p>
<p><!-- /wp:paragraph --></p>
